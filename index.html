<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>jcircuit by dhh1128</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <header>
        <h1>jcircuit</h1>
        <p>pure java impl of circuit breaker design pattern</p>
      </header>

      <div id="banner">
        <span id="logo"></span>

        <a href="https://github.com/dhh1128/jcircuit" class="button fork"><strong>View On GitHub</strong></a>
        <div class="downloads">
          <span>Downloads:</span>
          <ul>
            <li><a href="https://github.com/dhh1128/jcircuit/zipball/master" class="button">ZIP</a></li>
            <li><a href="https://github.com/dhh1128/jcircuit/tarball/master" class="button">TAR</a></li>
          </ul>
        </div>
      </div><!-- end banner -->

    <div class="wrapper">
      <nav>
        <ul></ul>
      </nav>
      <section>
        <h3>
<a id="error-handling" class="anchor" href="#error-handling" aria-hidden="true">
<span aria-hidden="true" class="octicon octicon-link"></span></a>Graceful, Robust Error Handling</h3>

<p>
    Error handling is a complex topic. It's all well and good to throw exceptions, or to return EACCES, or to
    log problems--but how do you handle failures in the error handling code itself? How do you test alternate
    code paths? What happens if a spike in errors floods your logs, and the error handling logic is so
    expensive that it brings the rest of the system to its knees? What do you do if a system is unhealthy, but
    not definitively broken? How can you degrade behavior gracefully?
</p>

<p>
    Circuit breakers are a useful approach to many of these concerns. They encapsulate orderly degradation and
    retry logic, and provide a simple interface for automation and testing.
</p>

<p>
More reading about circuit breakers and error handling:
    <a href="http://codecraft.co/2013/01/11/dont-forget-the-circuit-breakers/">"Don't forget the circuit breakers"</a> |
    <a href="http://codecraft.co/2012/09/03/good-code-plans-for-problems/">"Good Code Plans for Problems"</a> |
    <a href="http://codecraft.co/2013/05/06/why-your-software-should-cry/">"Why Your Software Should Cry"</a> |
    <a href="http://codecraft.co/2015/02/05/know-your-limits/">"Know Your Limits"</a> |
    <a href="http://codecraft.co/2014/01/15/add-some-more-extra-redundancy-again/">"Add some more extra redundancy again"</a>
</p>
<h3>
<a id="about-package" class="anchor" href="#about-package" aria-hidden="true">
<span aria-hidden="true" class="octicon octicon-link"></span></a>About This Package</h3>

<p>
    The jcircuit library is a tidy little package that implements the circuit breaker design pattern (as articulated
    by Michael Nygard in <em>Release It!</em>) with no external dependencies. It is compatible with java 6+. It is well
    tested, reasonably documented, and efficient even under very demanding concurrency. Plus it's free
    (<a href="https://github.com/dhh1128/jcircuit/blob/master/LICENSE">MIT license</a>).
    Please put it to work to make software better for all of us.
</p>
<h3>
  <a id="getting-started" class="anchor" href="#about-package" aria-hidden="true">
  <span aria-hidden="true" class="octicon octicon-link"></span></a>Getting Started</h3>
<p>
    1. Add this block to the <code>&lt;dependencies&gt;</code> section of your pom.xml:
</p>

<pre>
&lt;dependency&gt;
    &lt;groupId&gt;co.codecraft&lt;/groupId&gt;
    &lt;artifactId&gt;jcircuit&lt;/artifactId&gt;
    &lt;version&gt;1.0&lt;/version&gt;
&lt;/dependency&gt;
</pre>

<p>
    2. Create a <a href="apidocs/co/codecraft/jcircuit/CircuitBreaker.html">CircuitBreaker</a> to manage a codepath
    that needs to degrade gracefully:
</p>
<pre>
<span style="color:#8080c0">private static</span> <a href="apidocs/co/codecraft/jcircuit/CircuitBreaker.html">CircuitBreaker</a> savePayloadBreaker =
    <span style="color:#8080c0">new</span> CircuitBreaker(
        <span style="color:#8080c0">new</span> <a href="apidocs/co/codecraft/jcircuit/TimedRatioPolicy.html">TimedRatioPolicy</a>().builder()
          .<a href="apidocs/co/codecraft/jcircuit/TimedRatioPolicy.html#evalEveryNMillis">setEvalEveryNMillis</a>(1000)  <span style="color:#80c080">// check health 1x/sec</span>
          .<a href="apidocs/co/codecraft/jcircuit/TimedRatioPolicy.html#openAtGoodRatio">setOpenAtGoodRatio</a>(0.5)    <span style="color:#80c080">// if ok &lt; 50% of time, trip</span>
          .<a href="apidocs/co/codecraft/jcircuit/TimedRatioPolicy.html#closeAtGoodRatio">setCloseAtGoodRatio</a>(0.7)   <span style="color:#80c080">// close again if &gt;= 70% ok</span>
          .<a href="apidocs/co/codecraft/jcircuit/TimedRatioPolicy.html#resetAfterNMillis">setResetAfterNMillis</a>(5000) <span style="color:#80c080">// try to reset after 5 secs</span>
          .build());
</pre>

<p>
    3. Put the circuit breaker to work:
</p>

<pre>
<span style="color:#8080c0">public void</span> savePayload(Payload p) {
    <span style="color:#80c080">// Let circuit breaker influence code path.
    // Tell it about outcome so it can update its state.</span>
    <span style="color:#8080c0">if</span> (savePayloadBreaker.<a href="apidocs/co/codecraft/jcircuit/CircuitBreaker.html#shouldTryNormalPath--">shouldTryNormalPath</a>()) {
        <span style="color:#8080c0">try</span> {
            server.save(p); <span style="color:#80c080">// we think we're healthy</span>
            savePayloadBreaker.<a href="apidocs/co/codecraft/jcircuit/CircuitBreaker.html#onGoodPulse--">onGoodPulse</a>(); <span style="color:#80c080">// yep!</span>
        } <span style="color:#8080c0">catch</span> (ServerBusyException e) {
            savePayloadBreaker.<a href="apidocs/co/codecraft/jcircuit/CircuitBreaker.html#onBadPulse-java.lang.Throwable-">onBadPulse</a>(e); <span style="color:#80c080">// warning sign</span>
        }
    } <span style="color:#8080c0">else</span> {
        savePayloadToTempFolder(p); <span style="color:#80c080">// fallback logic</span>
        savePayloadBreaker.<a href="apidocs/co/codecraft/jcircuit/CircuitBreaker.html#onAltPulse--">onAltPulse</a>();
    }
}
</pre>

<h3>
<a id="api-docs" class="anchor" href="#api-docs" aria-hidden="true">
<span aria-hidden="true" class="octicon octicon-link"></span></a>API Docs</h3>

<p>
    An overview of key concepts, plus sample usage and descriptions of each class and method, can be found in the
    generated <a href="apidocs/index.html">javadoc</a> (or by reading <a href="https://github.com/dhh1128/jcircuit">the code</a>).
</p>

<h3>
  <a id="contribute" class="anchor" href="#contribute" aria-hidden="true">
  <span aria-hidden="true" class="octicon octicon-link"></span></a>Contribute</h3>
<p>
    Many of the <a href="apidocs/co/codecraft/jcircuit/TransitionPolicy.html">policy classes</a> written to
    govern circuit breakers are going to be special purpose. However, we are interested
    in adding general-purpose ones to the jcircuit package. If you create one (or if you improve tests or fix a bug),
    please open a pull request so your brilliance and elbow grease can be shared with everyone.
</p>

      </section>
      <footer>
        <p>Project maintained by <a href="https://github.com/dhh1128">dhh1128</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
